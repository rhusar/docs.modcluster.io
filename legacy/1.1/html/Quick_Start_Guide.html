<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 2. Quick Start Guide</title><link rel="stylesheet" href="css/jbossorg.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="mod_cluster Documentation"/><link rel="up" href="index.html" title="mod_cluster Documentation"/><link rel="prev" href="Intro.html" title="Chapter 1. Overview"/><link rel="next" href="native.config.html" title="Chapter 3. httpd configuration"/></head><body><p id="title"><a href="http://www.jboss.org" class="site_href"><strong>JBoss.org</strong></a><a href="http://docs.jboss.org/" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="Intro.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="native.config.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="Quick_Start_Guide"/>Chapter 2. Quick Start Guide</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="Quick_Start_Guide.html#d0e250">2.1. Download mod_cluster components</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e261">2.2. Install the httpd binary</a></span></dt><dd><dl><dt><span class="section"><a href="Quick_Start_Guide.html#d0e264">2.2.1. Install the whole httpd</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e276">2.2.2. Install only the modules</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e304">2.2.3. Install in home directory</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e315">2.2.4. Install in Windows</a></span></dt></dl></dd><dt><span class="section"><a href="Quick_Start_Guide.html#d0e349">2.3. Configure httpd</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e363">2.4. Install the server-side binaries</a></span></dt><dd><dl><dt><span class="section"><a href="Quick_Start_Guide.html#d0e370">2.4.1. Installing in JBoss AS 6.x</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e375">2.4.2. Installing in JBoss AS 5.x</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e382">2.4.3. Installing in JBoss Web or Tomcat</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e389">2.4.4. Installing in JBoss AS 4.2.x or 4.3.x</a></span></dt></dl></dd><dt><span class="section"><a href="Quick_Start_Guide.html#d0e396">2.5. Configuring the server-side</a></span></dt><dd><dl><dt><span class="section"><a href="Quick_Start_Guide.html#d0e399">2.5.1. Configuring mod_cluster with JBoss AS 5.x+</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e404">2.5.2. Configuring mod_cluster with standalone JBoss Web or Tomcat</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e414">2.5.3. Integrate mod_cluster with JBoss AS 4.2.x and 4.3.x</a></span></dt></dl></dd><dt><span class="section"><a href="Quick_Start_Guide.html#d0e424">2.6. Start httpd</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e431">2.7. Start the back-end server</a></span></dt><dd><dl><dt><span class="section"><a href="Quick_Start_Guide.html#d0e434">2.7.1. Starting JBoss AS</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e439">2.7.2. Starting JBossWeb or Tomcat</a></span></dt></dl></dd><dt><span class="section"><a href="Quick_Start_Guide.html#d0e444">2.8. Set up more back-end servers</a></span></dt><dt><span class="section"><a href="Quick_Start_Guide.html#d0e449">2.9. Experiment with the Load Balancing Demo Application</a></span></dt></dl></div><p>
    The following are the steps to set up a minimal working installation of mod_cluster on a single httpd server and a single back end server, either JBoss AS, JBossWeb or Tomcat.
    The steps can be repeated to add as many httpd servers or back end servers to your cluster as is desired.
  </p><p>
    The steps shown here are not intended to demonstrate how to set up a production install of mod_cluster;
    for example <a href="UsingSSL.html" title="Chapter 12. Using SSL in mod_cluster">using SSL to secure access</a> to the httpd-side mod_manager component is not covered.
    See the <a href="native.config.html" title="Chapter 3. httpd configuration">httpd-side</a> and <a href="java.config.html" title="Chapter 6. Server-side Configuration">java-side</a> configuration documentation for the full set of configuration options.
  </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e250"/>2.1. Download mod_cluster components</h2></div></div></div><p>
      Download the latest <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.jboss.org/mod_cluster/downloads/latest.html">httpd and java release bundles</a>.
      If there is no pre-built httpd bundle appropriate for your OS or system architecture, you can <a href="native.building.html" title="Chapter 4. Building httpd modules">build the binary from source</a>.
    </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e261"/>2.2. Install the httpd binary</h2></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e264"/>2.2.1. Install the whole httpd</h3></div></div></div><p>
        The httpd-side bundles are gzipped tars and include a full httpd install.
        As they contain already an Apache httpd install you don't need to download Apache httpd.
        Just extract them in root, e.g.
      </p><pre class="programlisting">cd /
tar xvf mod-cluster-1.0.0-linux2-x86-ssl.tar.gz</pre><p>
        That will give you a full httpd install in your <code class="code">/opt/jboss</code> directory.
      </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e276"/>2.2.2. Install only the modules</h3></div></div></div><p>
        If you already have a working httpd install that you would prefer
        to use, you'll need to download the bundle named mod_cluster httpd
        dynamic libraries corresponding to you plaform, extract the modules and
        copy them directory to your httpd install's module directory.
      </p><pre class="programlisting">cd /tmp
tar xvf mod_cluster-1.0.0.CR2-linux2-x86-so.tar.gz</pre><p>
        And then you have to copy the files below to you module directory:
      </p><div class="itemizedlist"><ul><li><p>mod_proxy.so</p></li><li><p>mod_proxy_ajp.so</p></li><li><p>mod_slotmem.so</p></li><li><p>mod_manager.so</p></li><li><p>mod_proxy_cluster.so</p></li><li><p>mod_advertise.so</p></li></ul></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e304"/>2.2.3. Install in home directory</h3></div></div></div><p>
        Since 1.1.0.CR2 a script <code class="code">opt/jboss/httpd/sbin/installhome.sh</code>
        allows reconfiguration of the bundle installation so that it can run in
        user's home directory.
        To do that just extract the bundle in your home directory and run the script.
        Once that done, httpd will run on port 8000 and will accept MCMP messages on
        localhost:6666 and offer <code class="code">/mod_cluster_manager</code> on the same host and port.</p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e315"/>2.2.4. Install in Windows</h3></div></div></div><p>
        Unzip the bundle corresponding to your architecture.
      </p><p>
        Change to the bin directory of the subfolder httpd-2.2 where you unzip the bundle
        and run the installconf.bat shell script.
      </p><pre class="programlisting">cd httpd-2.2\bin
       installconf.bat</pre><p>
      </p><p>
        You may run httpd directly by using:
      </p><pre class="programlisting">httpd.exe</pre><p>
        or install Apache httpd as a service:
      </p><pre class="programlisting">httpd.exe -k install</pre><p>
        and start the service via net start or using httpd.exe:
      </p><pre class="programlisting">net start Apache2.2</pre><p>
      </p><pre class="programlisting">httpd.exe -k start</pre><p>
      </p><p>
        Note that in the windows bundles have a flat directory structure, so you have <span class="emphasis"><em>httpd-2.2/modules/</em></span> instead of
        <code class="code">opt/jboss/httpd/lib/httpd/modules</code>.
      </p></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e349"/>2.3. Configure httpd</h2></div></div></div><p>
      Since 1.1.0.CR2 httpd.conf is preconfigured with the Quick Start values.
      You should adapt the default values to your configuration with older mod_cluster we will have to add the following to httpd.conf.
      If you extracted the download bundle to root as shown above and are using that extract as your httpd install,
      httpd.conf is located in <code class="code">/opt/jboss/httpd/httpd/conf</code>.
    </p><pre class="programlisting">LoadModule proxy_module /opt/jboss/httpd/lib/httpd/modules/mod_proxy.so
LoadModule proxy_ajp_module /opt/jboss/httpd/lib/httpd/modules/mod_proxy_ajp.so
LoadModule slotmem_module /opt/jboss/httpd/lib/httpd/modules/mod_slotmem.so
LoadModule manager_module /opt/jboss/httpd/lib/httpd/modules/mod_manager.so
LoadModule proxy_cluster_module /opt/jboss/httpd/lib/httpd/modules/mod_proxy_cluster.so
LoadModule advertise_module /opt/jboss/httpd/lib/httpd/modules/mod_advertise.so
 
Listen 10.33.144.3:6666
&lt;VirtualHost 10.33.144.3:6666&gt;
 
  &lt;Directory /&gt;
    Order deny,allow
    Deny from all
    Allow from 10.33.144.
  &lt;/Directory&gt;
 
  KeepAliveTimeout 60
  MaxKeepAliveRequests 0
 
  ManagerBalancerName mycluster
  AdvertiseFrequency 5
 
&lt;/VirtualHost&gt;</pre><p>
      If you are using your own install of httpd, httpd.conf is found in your install's conf directory.
      The content to add to httpd.conf is slightly different from the above (different path to the various .so files):
    </p><pre class="programlisting">LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_ajp_module modules/mod_proxy_ajp.so
LoadModule slotmem_module modules/mod_slotmem.so
LoadModule manager_module modules/mod_manager.so
LoadModule proxy_cluster_module modules/mod_proxy_cluster.so
LoadModule advertise_module modules/mod_advertise.so
 
Listen 10.33.144.3:6666
&lt;VirtualHost 10.33.144.3:6666&gt;
 
  &lt;Directory /&gt;
    Order deny,allow
    Deny from all
    Allow from 10.33.144.
  &lt;/Directory&gt;
 
  KeepAliveTimeout 60
  MaxKeepAliveRequests 0
 
  ManagerBalancerName mycluster
  AdvertiseFrequency 5
 
&lt;/VirtualHost&gt;</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e363"/>2.4. Install the server-side binaries</h2></div></div></div><p>
      First, extract the java-side binary to a temporary directory.
      The following assumes it was extracted to /tmp/mod-cluster
    </p><p>
      Your next step depends on whether your target server is JBoss AS or JBoss Web/Tomcat.
    </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e370"/>2.4.1. Installing in JBoss AS 6.x</h3></div></div></div><p>
        You don't need to do anything to install the java-side binaries in AS 6.x;
        it's part of the AS distribution's default, standard and all configurations.
      </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e375"/>2.4.2. Installing in JBoss AS 5.x</h3></div></div></div><p>
        Assuming $JBOSS_HOME indicates the root of your JBoss AS install and that you want to use mod_cluster in the AS's all config:
      </p><pre class="programlisting">cp -r /tmp/mod-cluster/mod-cluster.sar $JBOSS_HOME/server/all/deploy</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e382"/>2.4.3. Installing in JBoss Web or Tomcat</h3></div></div></div><p>
        Assuming $CATALINA_HOME indicates the root of your JBoss Web or Tomcat install:
      </p><pre class="programlisting">cp -r /tmp/mod-cluster/JBossWeb-Tomcat/lib/*
      $CATALINA_HOME/lib/ </pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e389"/>2.4.4. Installing in JBoss AS 4.2.x or 4.3.x</h3></div></div></div><p>
        Assuming $JBOSS_HOME indicates the root of your JBoss AS install and that you want to use mod_cluster in the AS's all config:
      </p><pre class="programlisting">cp -r /tmp/mod-cluster/JBossWeb-Tomcat/lib/mod-cluster.jar $JBOSS_HOME/server/all/deploy/jboss-web.deployer</pre></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e396"/>2.5. Configuring the server-side</h2></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e399"/>2.5.1. Configuring mod_cluster with JBoss AS 5.x+</h3></div></div></div><p>
        No post-installation configuration necessary!
      </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e404"/>2.5.2. Configuring mod_cluster with standalone JBoss Web or Tomcat</h3></div></div></div><p>
        Edit the <code class="code">$CATALINA_HOME/conf/server.xml</code> file, adding the following next to the other &lt;Listener/&gt; elements:
      </p><pre class="programlisting">&lt;Listener className="org.jboss.modcluster.catalina.ModClusterListener" advertise="true"/&gt;</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e414"/>2.5.3. Integrate mod_cluster with JBoss AS 4.2.x and 4.3.x</h3></div></div></div><p>
        Edit the <code class="code">$JBOSS_HOME/server/all/deploy/jboss-web.deployer/server.xml</code> file, adding the following next to the other &lt;Listener/&gt; elements:
      </p><pre class="programlisting">&lt;Listener className="org.jboss.modcluster.catalina.ModClusterListener" advertise="true"/&gt;</pre></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e424"/>2.6. Start httpd</h2></div></div></div><p>To start httpd do the following:</p><pre class="programlisting">/opt/jboss/httpd/sbin/apachectl start</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e431"/>2.7. Start the back-end server</h2></div></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e434"/>2.7.1. Starting JBoss AS</h3></div></div></div><pre class="programlisting">cd $JBOSS_HOME/bin
./run.sh -c all</pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="d0e439"/>2.7.2. Starting JBossWeb or Tomcat</h3></div></div></div><pre class="programlisting">cd $CATALINA_HOME
./startup.sh</pre></div></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e444"/>2.8. Set up more back-end servers</h2></div></div></div><p>
      Repeat the back-end server install and configuration steps for each server in your cluster.
    </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="d0e449"/>2.9. Experiment with the Load Balancing Demo Application</h2></div></div></div><p>
      The <a href="demo.html" title="Chapter 15. Load Balancing Demo Application">load balancing demo application</a> is a good way to learn about mod_cluster's capabilities.
    </p></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="Intro.html"><strong>Prev</strong>Chapter 1. Overview</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="native.config.html"><strong>Next</strong>Chapter 3. httpd configuration</a></li></ul></body></html>